#lang LANGUAGE

; Two version of this file are automatically generated by 
; the build process. One for the racket language with the
; suffix -racket, and one for rosette with suffix -rosette.
; Do not edit the file with these suffices. Your changes will
; be lost!

(require "rosette.rkt")

(provide lambdas @ match coqify-list eq-dec?)

(define-syntax lambdas
  (syntax-rules ()
    [(lambdas () es ...) (begin es ...)]
    [(lambdas (a as ...) es ...) (lambda (a) (lambdas (as ...) es ...))]))

(define-syntax @
  (syntax-rules ()
    [(@ e) e]
    [(@ f a as ...) (@ (f a) as ...)]))

(define (curried-apply f args)
  (if (null? args) f (curried-apply (f (car args)) (cdr args))))

(define-syntax match
  (syntax-rules ()
    [(match e) (error (string-append "Pattern match failed for " (~a e)))]
    [(match e ((t as ...) f) cs ...)
      (let ([x e])
        (if (eq? 't (car x))
          (curried-apply (lambdas (as ...) f) (cdr x))
          (match x cs ...)))]))

(define (coqify-list l)
  (if (null? l)
    `(Nil)
    `(Cons ,(car l) ,(coqify-list (cdr l)))))

(define eq-dec? (lambdas (a b) (if (rosette-eq? a b) '(Left) '(Right))))
